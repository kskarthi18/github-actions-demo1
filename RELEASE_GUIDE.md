# GitHub Actions Release Guide

This repository contains GitHub Actions workflows to automatically build and release your DemoWebsite component.

## üöÄ Workflows

### 1. CI Build (`ci.yaml`)
- **Triggers**: On pushes to `main`/`develop` branches and pull requests
- **Purpose**: Validates builds and runs tests on every change
- **Outputs**: Build validation artifacts (for PRs)

### 2. Build and Release (`release.yaml`)
- **Triggers**: 
  - Automatically on version tags (e.g., `v1.0.0`, `v2.1.3`)
  - Manually via GitHub Actions UI
- **Purpose**: Creates official releases with deployment packages
- **Outputs**: 
  - GitHub Release with changelog
  - ZIP and TAR.GZ deployment packages
  - Build artifacts

## üìã How to Create a Release

### Method 1: Automatic Release (Recommended)

1. **Create and push a version tag**:
   ```bash
   git tag v1.0.0
   git push origin v1.0.0
   ```

2. **The workflow will automatically**:
   - Build the application
   - Run tests (if any exist)
   - Create deployment packages
   - Generate a changelog from git commits
   - Create a GitHub release
   - Upload release assets

### Method 2: Manual Release

1. **Go to GitHub Actions tab** in your repository
2. **Select "Build and Release" workflow**
3. **Click "Run workflow"**
4. **Enter the version** (e.g., `v1.0.0`)
5. **Click "Run workflow"**

## üì¶ Release Assets

Each release includes:

- **DemoWebsite-vX.X.X.zip** - Windows/Cross-platform deployment package
- **DemoWebsite-vX.X.X.tar.gz** - Linux/Unix deployment package
- **Automated changelog** based on git commits since last release
- **Release notes** automatically generated by GitHub

## üè∑Ô∏è Version Tags

Use semantic versioning for your tags:

- **Major version**: `v2.0.0` (breaking changes)
- **Minor version**: `v1.1.0` (new features, backward compatible)
- **Patch version**: `v1.0.1` (bug fixes)
- **Pre-release**: `v1.0.0-alpha.1`, `v1.0.0-beta.1`, `v1.0.0-rc.1`

## üîß Customization

### Environment Variables
You can customize the workflow by modifying these variables in `.github/workflows/release.yaml`:

```yaml
env:
  DOTNET_VERSION: '8.0.x'        # .NET version to use
  PROJECT_PATH: './DemoWebsite'   # Path to your project
  ARTIFACT_NAME: 'DemoWebsite'   # Name for release artifacts
```

### Adding Tests
If you add test projects to your solution, the workflow will automatically:
- Detect test projects (projects ending in `.Tests.csproj` or containing `Test` in the name)
- Run tests during the build process
- Include test results in the workflow

### Custom Deployment
The workflow includes a `deploy` job that runs after successful releases. You can customize this to:
- Deploy to Azure App Service
- Deploy to AWS
- Deploy to your own servers
- Update container registries
- Send notifications

## üõ°Ô∏è Security

- The workflows use **GitHub's built-in `GITHUB_TOKEN`** for creating releases
- No additional secrets are required for basic functionality
- For custom deployments, add secrets in **Settings > Secrets and variables > Actions**

## ÔøΩ Testing Your Setup

### Test Permissions (Before Creating Releases)
1. **Run the permission test workflow**:
   - Go to **Actions** tab
   - Select **"Test Permissions"**
   - Click **"Run workflow"**
   - This will verify if your GitHub token has the necessary permissions

2. **Check the results**:
   - If successful: Your setup is ready for releases
   - If failed: Follow the troubleshooting steps above

### Test Build (Without Release)
1. **Push to main branch** to trigger CI workflow
2. **Check build logs** in Actions tab
3. **Verify artifacts** are generated correctly

## ÔøΩüìà Monitoring

- **View workflow runs** in the Actions tab
- **Download artifacts** from completed runs
- **Monitor build status** with GitHub's status checks
- **Get notifications** for failed builds (configurable in GitHub settings)

## üêõ Troubleshooting

### Common Issues:

1. **GitHub Release fails with 403 error** (Most Common):
   - **Root Cause**: GitHub token lacks permissions to create releases
   - **Solutions**:
     
     **Option A: Update Repository Settings (Recommended)**
     1. Go to **Settings** ‚Üí **Actions** ‚Üí **General**
     2. Scroll to **Workflow permissions**
     3. Select **"Read and write permissions"**
     4. Check **"Allow GitHub Actions to create and approve pull requests"**
     5. Click **Save**
     
     **Option B: Use Personal Access Token**
     1. Go to **Settings** ‚Üí **Developer settings** ‚Üí **Personal access tokens** ‚Üí **Tokens (classic)**
     2. Generate new token with `repo` scope (full repository access)
     3. Copy the token
     4. In your repository: **Settings** ‚Üí **Secrets and variables** ‚Üí **Actions**
     5. Add new secret: Name = `PERSONAL_TOKEN`, Value = your token
     6. Update the workflow to use `GITHUB_TOKEN: ${{ secrets.PERSONAL_TOKEN }}`

2. **Workflow doesn't trigger on tag**:
   - Ensure the tag follows the pattern `v*.*.*`
   - Check that the tag was pushed: `git push origin --tags`
   - Verify the workflow file is in the default branch

3. **Build fails**:
   - Check the project path in `PROJECT_PATH` environment variable
   - Ensure all dependencies are properly configured
   - Review the workflow logs in the Actions tab

4. **Release creation fails with other errors**:
   - Verify repository permissions
   - Check that the tag doesn't already exist
   - Ensure you have admin or write access to the repository

### Getting Help:
- Check the workflow logs in the GitHub Actions tab
- Review the error messages in failed steps
- Ensure your project structure matches the workflow expectations

## üéØ Best Practices

1. **Use semantic versioning** for consistent releases
2. **Write meaningful commit messages** (they become part of the changelog)
3. **Test locally** before creating releases
4. **Use pre-release tags** (`alpha`, `beta`, `rc`) for testing
5. **Review generated releases** before announcing to users
